---
description: Template generation and boilerplate creation standards
globs: ["src/generators/**/*", "src/templates/**/*", "**/templates/*.ts"]
alwaysApply: false
---

# Template Generation Standards

## TEMPLATE SYSTEM ARCHITECTURE
- Use **TypeScript template functions** returning string literals for type safety and IDE support
- **Modular organization**: Each package type (ui, api, db) has its own generator and templates directory
- **Type-safe parameters**: All templates accept `ProjectConfig` interface for consistent configuration
- **Conditional logic**: Use native TypeScript/JavaScript for feature-based template customization
- **Real validation**: Generated code is tested with actual Python/Node.js toolchains
- **No external dependencies**: Templates are pure TypeScript functions, no mustache/handlebars files

## TYPESCRIPT TEMPLATE PATTERNS
```typescript
// ✅ Good: Type-safe template function
export function generateMainPy(config: ProjectConfig): string {
  return `
from fastapi import FastAPI

app = FastAPI(
    title="${config.name} API",
    description="${config.description}",
    version="0.1.0",
)

${config.features.db ? 'from .database import init_db' : ''}
${config.features.db ? '@app.on_event("startup")\nasync def startup():\n    await init_db()' : ''}
`.trim();
}

// ❌ Bad: External template files
// Don't use .mustache, .hbs, or .template files
```

## TEMPLATE STACK SPECIFICS
- **Python API**: FastAPI + Pydantic v2 + SQLAlchemy 2.0 (async) + Alembic
- **Python tooling**: uv (package manager), ruff (linting/formatting), mypy (type checking), pytest + pytest-asyncio
- **React frontend**: Vite + TanStack Router + TanStack React Query + React 19
- **UI components**: Radix UI + Tailwind CSS + class-variance-authority + tailwind-merge
- **Frontend testing**: Vitest + @vitest/ui + @vitest/coverage-v8
- **Component development**: Storybook v8 for isolated component development
- **Monorepo**: Turbo for task orchestration, pnpm workspaces for dependency management
- **Database**: PostgreSQL with asyncpg driver and Alembic migrations
- **Infrastructure**: Helm charts with Bitnami PostgreSQL dependency
- **Development**: Docker Compose for local development with hot reload

## BACKWARDS COMPATIBILITY
- Version template formats to allow upgrades
- Maintain compatibility with projects generated by previous versions
- Provide clear upgrade paths when breaking changes are necessary
- Document template changes in CHANGELOG

## TEMPLATE VALIDATION STRATEGY
- **Three-layer testing**: Unit tests for template functions → Integration tests for generators → E2E tests with real tools
- **TypeScript validation**: Template functions are type-checked at compile time with ProjectConfig interface
- **Syntax validation**: Use `python3 -m py_compile` for Python syntax, `tsc --noEmit` for TypeScript
- **Real tool validation**: Run generated projects' native tools (pytest, ruff, mypy, vite build, pnpm lint)
- **Integration validation**: Generate projects in temp directories, install dependencies, run full test suites
- **Server validation**: Start generated FastAPI/Vite dev servers and test health endpoints
- **Production validation**: Build Docker images, lint Helm charts, test deployment readiness